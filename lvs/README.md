# LVS linux virtual server

* ## DR 模式

  DR模式，客户端请求包到达负载均衡虚拟的IP端口后，负载均衡改写请求包的目的MAC地址为后端RS的MAC地址;

真实服务器收到请求后直接返回给客户端，不经过负载均衡，DR模式效率最高，适合下行流量打的业务场景。

* ### 数据包到达负载均衡后，只有源，目的MAC地址被改写，IP ，端口不变

* ### RS必须还回口绑定VIP且端口必须和负载均衡一致，才能收包处理

* ### RS收包处理后直接返回客户端，负载均衡和RS必须位于同一个子网

配置步骤

* LB上

```
ifconfig eth0:0 172.30.81.213/24
ipvsadm -A -t 172.30.81.213:80 -s rr
ipvsadm -a -t 172.30.81.213:80 -r 172.30.81.194
ipvsadm -a -t 172.30.81.213:80 -r 172.30.81.194
```

* RS上

```
ifconfig lo:0 172.30.81.213/32
```



